{% extends "base.html" %}
{% load i18n static %}

{% block content %}
<div id="app" class="az-content-body">
	<div class="az-content-body-left col-8">
		<div class="row row-sm mg-b-20">
			<div class="col-lg-12">
				<div class="card card-table-two">
					<h6 class="card-title mg-b-20">Captura</h6>
					<br/>
					<div class="alert alert-danger tx-11" v-show="error_init">
						Ha ocurrido un error al intentar iniciar la captura
					</div>
					<p class="text-center">
						<img :src="image_capture" height="500" width="90%" v-if="video==='no_signal'">

						<img src="{% url 'video_streaming_capture' %}" height="500" width="90%" v-if="video==='loading'">
					</p>
				</div><!-- card-dashboard-five -->
			</div><!-- col -->
		</div><!-- row -->
		<!-- END GRID 1 -->
	</div>

	<!-- NOTIFICATIONS -->
	<div class="az-content-body-right col-4">
		<label class="az-content-label tx-base mg-b-25">
			Captura de Rostro
		</label>
		<div>
			<div class="az-media-list-reviews">
				<div class="media">
					<div class="media-body">
						<div>
							<strong>Seleccione una cámara:</strong>
							<select class="form-control" id="list_cameras" v-model="camara">
								<option value="">Seleccione uno</option>
								{% for camera in cameras%}
									<option value="{{camera.id}}">
									    {{camera.description}}
									</option>
								{% endfor %}
							</select>
							<span class="text-danger tx-10" v-show="error_camara">Debe seleccionar una cámara</span>
						</div>
						<div class="pt-2">
							{% csrf_token %}
							<strong>Nombre de la persona:</strong>
							<input class="form-control" placeholder="Nombre" type="text" name="person_name" id="person_name" v-model="person_name">
							<div v-show="error_name">
								<span class="text-danger tx-10">Este campo es requerido</span>
							</div>
							<div>
								<span class="text-info tx-10"><strong>Nota:</strong> Puede indicar un nombre registrado para ampliar su base de imágenes</span>
							</div>						
							<br/>
							<button class="btn btn-outline-light btn-block"
							@click="activeCapture">Iniciar</button>
						</div>
					</div><!-- media-body -->
				</div><!-- media -->
			</div><!-- media-list -->
			
		</div>
	</div>
    <!-- END NOTIFICATIONS -->
</div><!-- az-content-body -->
{% endblock content %}

{% block extra_css %}
    <link href="{% static 'azia_dashboard/lib/select2/css/select2.min.css' %}" rel="stylesheet">
{% endblock extra_css %}

{% block extra_js %}
	<script src="{% static 'pkg/vue.js' %}"></script>
	<script src="{% static 'pkg/axios.js' %}"></script>
	<script src="{% static 'js/capture_face.js' %}"></script>
    <script>
	    $("#list_persons").change(function() {
			var name = $("#list_persons").val();
			$("#person_name").val(name);
		});
	</script>
{% endblock extra_js %}